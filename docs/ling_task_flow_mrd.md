# 凌云任务管理应用（LingTaskFlow）产品需求文档

## 📋 项目概述

### 产品名称

凌云任务管理应用（LingTaskFlow）

### 产品定位

一个面向个人用户的轻量级任务管理工具，支持任务的全生命周期管理，帮助用户高效组织和跟踪个人工作任务。

### 技术架构

- **前端**：Vue 3 + Quasar Framework + shadcn-vue
- **后端**：Django + Django REST Framework（DRF）
- **认证方式**：JWT（JSON Web Token）
- **数据库**：SQLite（开发阶段）/ PostgreSQL（生产环境）

---

## 🎯 核心功能需求

### 1. 用户认证模块

#### 1.1 用户注册

- **功能描述**：新用户创建账户
- **输入字段**：
    - 用户名（必填，3-20 字符，唯一性校验）
    - 邮箱地址（必填，格式校验，唯一性校验）
    - 密码（必填，8-128 字符，包含数字和字母）
    - 确认密码（必填，与密码一致性校验）
- **业务规则**：
    - 用户名不能重复
    - 邮箱格式验证
    - 密码强度验证
    - 注册成功后自动登录
- **返回结果**：注册成功返回用户信息和 JWT 令牌

#### 1.2 用户登录

- **功能描述**：已注册用户身份验证
- **输入字段**：
    - 用户名/邮箱（必填）
    - 密码（必填）
- **业务规则**：
    - 支持用户名或邮箱登录
    - 密码错误次数限制（连续 5 次错误锁定 30 分钟）
    - JWT 令牌有效期设置（24 小时）
- **返回结果**：登录成功返回用户信息和 JWT 令牌

#### 1.3 用户登出

- **功能描述**：用户主动退出系统
- **业务规则**：
    - 清除前端存储的 JWT 令牌
    - 可选择性将令牌加入黑名单

### 2. 任务管理模块

#### 2.1 任务数据模型

```
Task Model:
- id: 主键（自动生成）
- title: 任务标题（必填，1-100字符）
- description: 任务描述（可选，最大1000字符）
- status: 任务状态（必填，枚举值）
- created_at: 创建时间（自动生成）
- updated_at: 更新时间（自动更新）
- user: 关联用户（外键）
```

#### 2.2 任务状态定义

- **待办（TODO）**：新创建的任务，尚未开始
- **进行中（IN_PROGRESS）**：正在执行的任务
- **已完成（COMPLETED）**：已经完成的任务
- **已取消（CANCELLED）**：被取消的任务

#### 2.3 创建任务

- **功能描述**：用户创建新任务
- **输入字段**：
    - 任务标题（必填）
    - 任务描述（可选）
    - 初始状态（默认为"待办"）
- **业务规则**：
    - 登录用户才能创建任务
    - 任务标题不能为空
    - 每个用户最多创建 1000 个任务
- **返回结果**：创建成功返回完整任务信息

#### 2.4 编辑任务

- **功能描述**：修改已有任务信息
- **可编辑字段**：
    - 任务标题
    - 任务描述
    - 任务状态
- **业务规则**：
    - 只能编辑自己创建的任务
    - 已取消的任务不能修改状态为其他状态
    - 更新时间自动刷新
- **返回结果**：更新成功返回更新后的任务信息

#### 2.5 删除任务

- **功能描述**：软删除任务（标记为已删除，不直接从数据库删除）
- **业务规则**：
    - 只能删除自己创建的任务
    - 软删除操作可恢复（30 天内）
    - 需要二次确认
    - 已删除任务不在常规列表中显示
- **返回结果**：删除成功返回操作状态

#### 2.6 恢复任务

- **功能描述**：恢复已软删除的任务
- **业务规则**：
    - 只能恢复自己删除的任务
    - 恢复后任务状态回到删除前状态
    - 删除超过 30 天的任务无法恢复
- **返回结果**：恢复成功返回任务信息

#### 2.7 查询任务列表

- **功能描述**：获取用户的任务列表
- **查询参数**：
    - 页码（分页，默认第 1 页）
    - 每页数量（默认 20 条，最大 100 条）
    - 状态筛选（可选，多状态支持）
    - 关键词搜索（可选，支持标题和描述搜索）
    - 排序方式（创建时间、更新时间，升序/降序）
    - 显示已删除（可选，默认 false）
- **业务规则**：
    - 只能查看自己创建的任务
    - 默认按创建时间倒序排列
    - 默认不显示软删除的任务
    - 可选择查看回收站（已删除但可恢复的任务）
- **返回结果**：分页任务列表和总数统计

### 3. 搜索与筛选模块

#### 3.1 状态筛选

- **功能描述**：按任务状态过滤任务列表
- **筛选选项**：
    - 全部状态
    - 待办
    - 进行中
    - 已完成
    - 已取消
    - 回收站（软删除的任务）
- **业务规则**：
    - 支持多状态同时筛选
    - 筛选结果实时更新
    - 回收站筛选单独处理，不与其他状态组合

#### 3.2 关键词搜索

- **功能描述**：按关键词搜索任务
- **搜索范围**：
    - 任务标题
    - 任务描述
- **搜索特性**：
    - 实时搜索（输入时动态筛选）
    - 不区分大小写
    - 支持部分匹配
    - 最小搜索长度 1 个字符
    - 可在回收站中搜索

### 4. 回收站管理模块

#### 4.1 查看回收站

- **功能描述**：查看用户的已删除任务
- **显示内容**：
    - 删除时间
    - 剩余恢复天数
    - 原任务信息
- **操作选项**：
    - 恢复任务
    - 永久删除

#### 4.2 批量操作

- **功能描述**：对回收站任务进行批量处理
- **操作类型**：
    - 批量恢复
    - 批量永久删除
    - 清空回收站
- **业务规则**：
    - 批量操作需二次确认
    - 永久删除不可恢复

---

## 🔧 技术需求

### 后端技术要求

#### API 设计规范

- **RESTful API**：遵循 REST 设计原则
- **响应格式**：统一 JSON 格式
- **状态码**：标准 HTTP 状态码
- **错误处理**：统一错误响应格式

#### 认证与授权

- **JWT 实现**：使用 Django REST Framework Simple JWT
- **令牌存储**：前端 localStorage 存储
- **权限控制**：基于用户身份的资源访问控制

#### 数据库设计

```sql
-- 用户表（使用Django内置User模型扩展）
User:
- id, username, email, password, date_joined, last_login

-- 任务表
Task:
- id (Primary Key)
- title (VARCHAR 100, NOT NULL)
- description (TEXT, NULLABLE)
- status (VARCHAR 20, DEFAULT 'TODO')
- is_deleted (BOOLEAN, DEFAULT FALSE)
- deleted_at (TIMESTAMP, NULLABLE)
- created_at (TIMESTAMP, AUTO)
- updated_at (TIMESTAMP, AUTO)
- user_id (Foreign Key to User)
```

#### 定时任务

- **清理任务**：定期清理超过 30 天的软删除任务
- **执行频率**：每日凌晨执行
- **实现方式**：Django-crontab 或 Celery

### 前端技术要求

#### 组件架构

- **Vue 3 Composition API**：现代 Vue 开发模式
- **Quasar Components**：UI 组件库
- **shadcn-vue**：高质量 UI 组件补充
- **Pinia**：状态管理
- **Vue Router**：路由管理

#### 页面结构

```
/login          - 登录页面
/register       - 注册页面
/dashboard      - 任务管理主页面
  /tasks        - 任务列表
  /tasks/new    - 创建任务
  /tasks/:id    - 任务详情/编辑
  /trash        - 回收站页面
```

---

## 🎨 用户界面需求

### 设计原则

- **简洁直观**：界面清晰，操作简单
- **响应式设计**：支持桌面端和移动端
- **一致性**：统一的视觉风格和交互模式

### 核心页面设计

#### 1. 登录/注册页面

- 居中布局的表单设计
- 表单验证提示
- 登录/注册切换
- "记住我"选项

#### 2. 任务管理主页

- **顶部导航栏**：
    - Logo 和应用名称
    - 用户头像和下拉菜单
    - 退出登录按钮
- **侧边栏/筛选区**：
    - 状态筛选选项
    - 搜索输入框
    - 任务统计信息
- **主内容区**：
    - 任务列表
    - 分页控件
    - 创建任务按钮

#### 3. 任务卡片设计

- 任务标题（突出显示）
- 任务描述（预览）
- 状态标签（彩色标识）
- 创建/更新时间
- 操作按钮（编辑、删除）

---

## 📊 性能需求

### 响应时间要求

- **页面加载**：首屏加载时间 < 2 秒
- **API 响应**：接口响应时间 < 500ms
- **搜索响应**：实时搜索响应 < 200ms

### 并发用户支持

- **开发阶段**：支持 10 个并发用户
- **生产环境**：支持 100 个并发用户

### 数据容量

- **单用户任务数**：最大 1000 个任务
- **用户规模**：初期支持 1000 个注册用户

---

## 🔒 安全需求

### 身份认证安全

- JWT 令牌加密存储
- 密码 bcrypt 哈希加密
- 登录失败次数限制
- 令牌过期自动刷新

### 数据安全

- SQL 注入防护
- XSS 攻击防护
- CSRF 保护
- 输入数据验证和清洗

### 权限控制

- 用户只能访问自己的数据
- API 接口权限验证
- 敏感操作二次确认

---

## 🚀 部署需求

### 开发环境

- **前端**：Vite 开发服务器
- **后端**：Django 开发服务器
- **数据库**：SQLite
- **代理配置**：解决跨域问题

### 生产环境

- **前端**：Nginx 静态文件服务
- **后端**：Gunicorn + Nginx
- **数据库**：PostgreSQL
- **HTTPS**：SSL 证书配置

---

## 📅 开发里程碑

### 第一阶段：基础功能开发（2 周）

- [ ] 项目环境搭建
- [ ] 用户认证模块
- [ ] 基础任务 CRUD 功能
- [ ] 简单的前端界面

### 第二阶段：功能完善（1 周）

- [ ] 任务搜索和筛选
- [ ] 界面优化和响应式设计
- [ ] 错误处理和用户反馈

### 第三阶段：测试和部署（1 周）

- [ ] 功能测试和修复
- [ ] 性能优化
- [ ] 生产环境部署
- [ ] 文档完善

---

## 📋 验收标准

### 功能验收

- [ ] 用户可以成功注册和登录
- [ ] 用户可以创建、编辑、删除任务
- [ ] 任务状态筛选功能正常
- [ ] 关键词搜索功能正常
- [ ] 分页功能正常

### 性能验收

- [ ] 页面加载时间符合要求
- [ ] API 响应时间符合要求
- [ ] 搜索响应时间符合要求

### 安全验收

- [ ] 用户数据隔离正确
- [ ] 身份认证安全可靠
- [ ] 输入验证防护有效

### 兼容性验收

- [ ] 主流浏览器兼容
- [ ] 移动端适配正常
- [ ] 不同屏幕尺寸显示正常

---

_文档版本：v1.0_  
_创建日期：2025 年 7 月 31 日_  
_最后更新：2025 年 7 月 31 日_
